var ThemeSetupTool=function(a){function b(e){var h=a("#"+tmc_theme_setup.theme_slug+"_license_key").val(),i=a(".tmc-license-status");a(".tmc-licenseinput").blur(),f();a.ajax({url:tmc_theme_setup.ajaxurl,type:"post",data:{action:"tmc_activate_theme_key",wpnonce:tmc_theme_setup.wpnonce,coderplace_license_activate:!0,coderplace_nonce:a(e).data("nonce"),key:h,attempt:l||0},beforeSend:function(a){i.addClass("active");var b=i.find("span").data("submit-message");i.find("span").text(b)},complete:function(f){f=f.responseJSON,"undefined"!=f.done&&1==f.done&&"undefined"!=f.valid&&1==f.valid?(console.log("license good"),a(".tmc-licenseinput").addClass("tmc-licenseinput--valid"),i.find("span").text(f.message),window.location.href=e.href):(console.log("license not good"),i.find("span").text(f.message),!0===f.retry?(console.log("retrying license activation"),l=f.attempt,b(e)):(console.log("license activation failed"),a(".tmc-licenseinput").addClass("tmc-licenseinput--invalid"),g(),a(".tmc-licenseinput").on("click",function(){console.log("Handler for .change() called."),d()})),c())}})}function c(){null!=k&&(k.done(),k=null)}function d(){var b=a(".tmc-license-status");b.find("span").text(""),b.removeClass("active");var c=a(".tmc-licenseinput");c.removeClass("tmc-licenseinput--valid"),c.removeClass("tmc-licenseinput--invalid")}function e(){a(".button-next").each(function(b,c){a(c).on("click",function(b){return console.log("button-next click"),!!(k=j(this))&&(a(this).data("callback")&&void 0!==m[a(this).data("callback")]?(f(),m[a(this).data("callback")](this),!1):(f(),!0))})}),a(".button-upload").on("click",function(a){a.preventDefault(),renderMediaUploader()}),a(".theme-presets a").on("click",function(b){b.preventDefault(),a(this).parents("ul").first().find(".current").removeClass("current"),a(this).parents("li").first().addClass("current");var c=a(this).data("style");return a("#new_style").val(c),!1}),a("input.tmc-licenseinput__input").change(function(){d()})}function f(){a(".tmc-setupwizard__content").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})}function g(){a(".tmc-setupwizard__content").unblock({})}function h(){function b(e){"object"==typeof e&&void 0!==e.responseJSON?(console.log("ajax callback"),e=e.responseJSON,g.find("span").text(e.message),void 0!==e.url?e.hash==j?(g.find("span").text("failed"),d()):(j=e.hash,a.ajax({url:e.url,type:"post",data:e,complete:function(a){c(),g.find("span").text(e.message+tmc_theme_setup.verify_text)},fail:b})):void 0!==e.done?(console.log("move on"),d()):(console.log("error"),d())):(g.find("span").text("ajax error"),console.log("ajax error"),d())}function c(){if(i){g.find("input:checkbox").is(":checked")?(console.log("processing-> "+i),f(),g.find(".spinner").addClass("is-active"),a.ajax({url:tmc_theme_setup.ajaxurl,type:"post",data:{action:"tmc_setup_plugins",wpnonce:tmc_theme_setup.wpnonce,slug:i},complete:b})):(console.log("skipping"),g.find("span").text("Skipping"),setTimeout(d,300))}}function d(){var b=!1;g&&(g.data("done_item")||(h++,g.data("done_item",1)),g.find(".spinner").removeClass("is-active"));var d=a(".tmc-plugin-li .tmc-plugin-item");d.each(function(){""===i||b?(console.log(a(this)),console.log("checkbox"),console.log(a(this).find("input:checkbox")),i=a(this).find("input:checkbox").data("slug"),g=a(this),console.log("currentItem"),console.log(i),c(),b=!1):a(this).find("input:checkbox").data("slug")==i&&(console.log("do next true"),b=!0)}),h>=d.length&&(console.log("complete"),e())}var e,g,h=0,i="",j="";return{init:function(b){a(".theme-install-setup-plugins").addClass("installing"),e=function(){f(),window.location.href=b.href},d()}}}function i(){function b(c){"object"==typeof c&&void 0!==c.responseJSON?(c=c.responseJSON,g.find("span").text(c.message),void 0!==c.url?c.hash==j?(g.find("span").text("failed"),d()):(j=c.hash,a.ajax({url:c.url,type:"post",data:c,complete:b})):(c.done,d())):(g.find("span").text("ajax error"),d())}function c(){if(i){g.find("input:checkbox").is(":checked")?(console.log("processing-> "+i),g.find(".spinner").addClass("is-active"),a.ajax({url:tmc_theme_setup.ajaxurl,type:"post",data:{action:"tmc_setup_content",wpnonce:tmc_theme_setup.wpnonce,add:i},complete:b})):(g.find("span").text("Skipping"),setTimeout(d,300))}}function d(){var b=!1;g&&(g.data("done_item")||(h++,g.data("done_item",1)),g.find(".spinner").removeClass("is-active"));var d=a("li.tmc-content-item");d.each(function(){""===i||b?(i=a(this).find("input:checkbox").data("content"),g=a(this),c(),b=!1):a(this).find("input:checkbox").data("content")==i&&(b=!0)}),h>=d.length&&e()}var e,g,h=0,i="",j="";return{init:function(b){a(".theme-install-setup-content").addClass("installing"),a(".theme-install-setup-content").find("input").prop("disabled",!0),e=function(){f(),window.location.href=b.href},d()}}}function j(a){function b(){if(!g){for(var a="",d=0;d<i.length;d++)i[d]=i[d]+1,i[d]>=f.length&&(i[d]=0),a+=f.charAt(i[d]);c[h](a),setTimeout(function(){b()},60)}}var c=jQuery(a),d=c.text(),e=c.outerWidth(),f="⡀⡀⡀⡀⡀⡀⡀⡀⡀⡀⠄⠂⠁⠁⠂⠄",g=!1;c.css("width",e),c.addClass("loading_btn_current");var h=c.is("input")||c.is("button")?"val":"text";c[h](f),c.attr("disabled",!0),c.data("done-loading","yes");var i=[0,1,2];return b(),{done:function(){g=!0,c[h](d),c.removeClass("loading_btn_current"),c.attr("disabled",!1)}}}var k,l,m={activateLicense:function(a){b(a)},installPlugins:function(a){(new h).init(a)},installContent:function(a){(new i).init(a)}};return{init:function(){t=this,a(e)},callback:function(a){console.log(a),console.log(this)}}}(jQuery);ThemeSetupTool.init();